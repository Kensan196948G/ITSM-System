# ===============================================
# ITSM-System HTTPS Configuration (Production)
# ===============================================

# -----------------------------------------------
# Server Configuration
# -----------------------------------------------
PORT=5000
NODE_ENV=production
HOST=0.0.0.0

# System IP Address (change this to your server IP)
SYSTEM_IP=192.168.0.187

# -----------------------------------------------
# HTTPS Configuration
# -----------------------------------------------
ENABLE_HTTPS=true
HTTPS_PORT=5443
SSL_CERT_PATH=./ssl/server.crt
SSL_KEY_PATH=./ssl/server.key

# HTTP to HTTPS Redirect
HTTP_REDIRECT_TO_HTTPS=true
HTTP_PORT=5000

# TLS Configuration
TLS_MIN_VERSION=TLSv1.2
TLS_MAX_VERSION=TLSv1.3

# -----------------------------------------------
# Frontend HTTPS Configuration
# -----------------------------------------------
FRONTEND_HTTPS_PORT=5050
FRONTEND_HTTP_PORT=8080

# -----------------------------------------------
# JWT Configuration
# -----------------------------------------------
# WARNING: Change this secret in production!
# Generate a random secret: openssl rand -base64 64
JWT_SECRET=CHANGE_THIS_TO_A_RANDOM_SECRET_IN_PRODUCTION
JWT_EXPIRES_IN=24h

# -----------------------------------------------
# CORS Configuration (HTTPS URLs)
# -----------------------------------------------
# Add your HTTPS URLs here
CORS_ORIGIN=https://192.168.0.187:5050,https://localhost:5050,http://localhost:3000

# -----------------------------------------------
# Database Configuration
# -----------------------------------------------
DATABASE_PATH=./backend/itsm_nexus.db

# -----------------------------------------------
# Logging Configuration
# -----------------------------------------------
LOG_LEVEL=info

# -----------------------------------------------
# Rate Limiting (Production Settings)
# -----------------------------------------------
# API Rate Limit: 100 requests per 15 minutes per IP
API_RATE_LIMIT_MAX=100
API_RATE_LIMIT_WINDOW_MS=900000

# Auth Rate Limit: 5 requests per 15 minutes per IP (brute force protection)
AUTH_RATE_LIMIT_MAX=5
AUTH_RATE_LIMIT_WINDOW_MS=900000

# Register Rate Limit: 3 requests per hour per IP
REGISTER_RATE_LIMIT_MAX=3
REGISTER_RATE_LIMIT_WINDOW_MS=3600000

# -----------------------------------------------
# Security Headers (Optional Override)
# -----------------------------------------------
# HSTS Max Age (1 year in seconds)
HSTS_MAX_AGE=31536000

# CSP Configuration
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline' https://cdn.jsdelivr.net
CSP_STYLE_SRC='self' 'unsafe-inline' https://cdn.jsdelivr.net
CSP_IMG_SRC='self' data: https:
CSP_CONNECT_SRC='self' https://192.168.0.187:5443 https://localhost:5443

# -----------------------------------------------
# Cache Configuration (Optional)
# -----------------------------------------------
# Cache TTL in seconds (default: 300 = 5 minutes)
CACHE_TTL=300

# Cache max size (default: 100 entries)
CACHE_MAX_SIZE=100

# -----------------------------------------------
# Backup Configuration (Optional)
# -----------------------------------------------
# Backup directory
BACKUP_DIR=./backend/backups

# Backup retention (days)
BACKUP_RETENTION_DAILY=7
BACKUP_RETENTION_WEEKLY=28
BACKUP_RETENTION_MONTHLY=365

# -----------------------------------------------
# Monitoring & Metrics (Optional)
# -----------------------------------------------
# Enable Prometheus metrics endpoint
ENABLE_METRICS=true

# Metrics port (if different from main server)
# METRICS_PORT=9090

# -----------------------------------------------
# Two-Factor Authentication (Optional)
# -----------------------------------------------
# 2FA issuer name
TWO_FACTOR_ISSUER=ITSM-Nexus

# -----------------------------------------------
# Session Configuration (Optional)
# -----------------------------------------------
# Session timeout in seconds
SESSION_TIMEOUT=300

# -----------------------------------------------
# Production Deployment Notes
# -----------------------------------------------
# 1. Generate SSL certificate:
#    ./scripts/generate-ssl-cert.sh 192.168.0.187
#
# 2. Generate secure JWT secret:
#    openssl rand -base64 64
#
# 3. Update CORS_ORIGIN with your HTTPS URLs
#
# 4. Change default admin password
#
# 5. Configure firewall:
#    sudo ufw allow 5443/tcp comment 'ITSM Backend HTTPS'
#    sudo ufw allow 5050/tcp comment 'ITSM Frontend HTTPS'
#
# 6. Install systemd services:
#    sudo cp systemd/itsm-system-https.service /etc/systemd/system/
#    sudo cp systemd/itsm-frontend-https.service /etc/systemd/system/
#    sudo systemctl daemon-reload
#    sudo systemctl enable itsm-system-https itsm-frontend-https
#    sudo systemctl start itsm-system-https itsm-frontend-https
#
# 7. Test HTTPS access:
#    curl -k https://192.168.0.187:5443/api/v1/health
#    curl -k https://192.168.0.187:5050/
