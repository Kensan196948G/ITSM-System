# SubAgent 7ä½“ å®šç¾©ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

## ğŸ“š æ¦‚è¦

æœ¬ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€ITSM-Sec Nexusãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ç”¨ã™ã‚‹SubAgent 7ä½“ã®è©³ç´°å®šç¾©ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ¤– SubAgent ä¸€è¦§

| # | Agentå | å½¹å‰² | æˆæœç‰© |
|---|---------|------|--------|
| 01 | **spec-planner** | è¦ä»¶ãƒ»é‹ç”¨å®šç¾© | `specs/overview.md`, `specs/requirements.md` |
| 02 | **arch-reviewer** | è¨­è¨ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ | `design/architecture.md`, `design/security.md` |
| 03 | **code-implementer** | å®Ÿè£… | `backend/**`, `frontend/**` |
| 04 | **code-reviewer** | è‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚²ãƒ¼ãƒˆ | `reviews/YYYYMMDD_feature_*.json` |
| 05 | **test-designer** | ãƒ†ã‚¹ãƒˆè¨­è¨ˆ | `tests/test_cases.md`, `backend/__tests__/**` |
| 06 | **test-reviewer** | ãƒ†ã‚¹ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ | `reviews/YYYYMMDD_test_*.json` |
| 07 | **ci-specialist** | CI/ãƒªãƒªãƒ¼ã‚¹ | `ci/pipeline.md`, `.github/workflows/**` |

## ğŸ”„ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆè‡ªå‹•é·ç§»ï¼‰

```
spec-planner
    â†“ (on-spec-complete)
arch-reviewer
    â†“ (on-arch-approved)
code-implementer
    â†“ (on-implementation-complete)
code-reviewer
    â†“ (on-code-review-result)
    â”œâ”€ FAIL â†’ code-implementerï¼ˆå·®ã—æˆ»ã—ï¼‰
    â”œâ”€ PASS_WITH_WARNINGS â†’ äººã«é€šçŸ¥ â†’ test-designer
    â””â”€ PASS â†’ test-designer
           â†“ (on-test-design-complete)
       test-reviewer
           â†“ (on-test-review-result)
           â”œâ”€ FAIL â†’ test-designerï¼ˆå·®ã—æˆ»ã—ï¼‰
           â””â”€ PASS â†’ ci-specialist
                  â†“
              ãƒªãƒªãƒ¼ã‚¹åˆ¤å®š
```

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ‰€æœ‰æ¨©ï¼ˆä¸¦åˆ—é–‹ç™ºãƒ«ãƒ¼ãƒ«ï¼‰

| Agent | æ‹…å½“ãƒ•ã‚¡ã‚¤ãƒ« |
|-------|------------|
| spec-planner | `specs/**`, `docs/**` |
| arch-reviewer | `design/**`, `systemd/**` |
| code-implementer | `backend/**`, `frontend/**`, `app.js` |
| code-reviewer | `reviews/*_code_*.json` |
| test-designer | `backend/__tests__/**`, `e2e/**`, `tests/**` |
| test-reviewer | `reviews/*_test_*.json` |
| ci-specialist | `ci/**`, `.github/workflows/**` |

## ğŸ›¡ å“è³ªã‚²ãƒ¼ãƒˆï¼ˆè‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹ï¼‰

### code-reviewer ã®5å¤§è¦³ç‚¹

1. **ä»•æ§˜æº–æ‹ **: å…¥å‡ºåŠ›ãŒä»•æ§˜ã©ãŠã‚Šã‹ã€è¦ä»¶æŠœã‘ãŒãªã„ã‹
2. **ä¾‹å¤–å‡¦ç†**: try/catchãŒã‚ã‚‹ã‹ã€ã‚¨ãƒ©ãƒ¼æ™‚ã«ç•°å¸¸çµ‚äº†ã—ãªã„ã‹
3. **ãƒ­ã‚°ãƒ»è¨¼è·¡**: æˆåŠŸãƒ­ã‚°ã€å¤±æ•—ãƒ­ã‚°ã€ç›£æŸ»è¨¼è·¡ãŒã‚ã‚‹ã‹
4. **æ¨©é™ãƒ»SoD**: æ¨©é™ãƒã‚§ãƒƒã‚¯ã€è·å‹™åˆ†é›¢ãŒå®Ÿç¾ã•ã‚Œã¦ã„ã‚‹ã‹
5. **å°†æ¥å¤‰æ›´è€æ€§**: ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰æ’é™¤ã€è¨­å®šå€¤å¤–å‡ºã—

### test-reviewer ã®ãƒã‚§ãƒƒã‚¯é …ç›®

1. **ç¶²ç¾…æ€§**: ã™ã¹ã¦ã®é‡è¦æ©Ÿèƒ½ãŒãƒ†ã‚¹ãƒˆã•ã‚Œã¦ã„ã‚‹ã‹
2. **ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å“è³ª**: æ­£å¸¸ç³»ãƒ»ç•°å¸¸ç³»ãƒ»å¢ƒç•Œå€¤ãƒ»æ¨©é™ç³»
3. **ç›£æŸ»ãƒ»è¨¼è·¡ãƒ†ã‚¹ãƒˆ**: ç›£æŸ»ãƒ­ã‚°è¨˜éŒ²ã€è¨¼è·¡æ¤œç´¢
4. **ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰å“è³ª**: ç‹¬ç«‹æ€§ã€å†ç¾æ€§ã€å¯èª­æ€§
5. **ã‚«ãƒãƒ¬ãƒƒã‚¸**: ãƒ¦ãƒ‹ãƒƒãƒˆ>=70%, ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ‘ã‚¹=100%

### ci-specialist ã®å“è³ªã‚²ãƒ¼ãƒˆ

1. **ãƒ†ã‚¹ãƒˆæˆåŠŸç‡** = 100%
2. **ã‚«ãƒãƒ¬ãƒƒã‚¸** >= 70%
3. **ESLint ã‚¨ãƒ©ãƒ¼** = 0
4. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ï¼ˆCritical/Highï¼‰** = 0
5. **ãƒ“ãƒ«ãƒ‰** = æˆåŠŸ

## ğŸš¦ åˆ¤å®šãƒ«ãƒ¼ãƒ«

### code-reviewer

| æ¡ä»¶ | åˆ¤å®š |
|-----|------|
| `blocking_issues > 0` | **FAIL** |
| `blocking_issues = 0` AND `warnings > 0` | **PASS_WITH_WARNINGS** |
| `blocking_issues = 0` AND `warnings = 0` | **PASS** |

### test-reviewer

| æ¡ä»¶ | åˆ¤å®š |
|-----|------|
| `blocking_issues > 0` | **FAIL** |
| `blocking_issues = 0` AND `coverage.unit < 70%` | **FAIL** |
| ãã®ä»– | **PASS** |

### ci-specialist

| æ¡ä»¶ | åˆ¤å®š |
|-----|------|
| ã™ã¹ã¦ã®å“è³ªã‚²ãƒ¼ãƒˆPASS | **GO** |
| 1ã¤ã§ã‚‚NG | **NO-GO** |

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### 1. æ–°æ©Ÿèƒ½é–‹ç™ºã®é–‹å§‹

```bash
# 1. spec-planner ã§è¦ä»¶å®šç¾©
claude "æ–°æ©Ÿèƒ½XXXã®è¦ä»¶ã‚’å®šç¾©ã—ã¦ãã ã•ã„"

# 2. è‡ªå‹•çš„ã« arch-reviewer ãŒèµ·å‹•ã•ã‚Œã‚‹ï¼ˆHookï¼‰

# 3. PASSå¾Œã€code-implementer ãŒèµ·å‹•ã•ã‚Œã‚‹ï¼ˆHookï¼‰

# 4. å®Ÿè£…å®Œäº†å¾Œã€code-reviewer ãŒè‡ªå‹•èµ·å‹•ï¼ˆHookï¼‰

# 5. PASSå¾Œã€test-designer ãŒè‡ªå‹•èµ·å‹•ï¼ˆHookï¼‰

# 6. ãƒ†ã‚¹ãƒˆè¨­è¨ˆå®Œäº†å¾Œã€test-reviewer ãŒè‡ªå‹•èµ·å‹•ï¼ˆHookï¼‰

# 7. PASSå¾Œã€ci-specialist ãŒè‡ªå‹•èµ·å‹•ï¼ˆHookï¼‰

# 8. ãƒªãƒªãƒ¼ã‚¹åˆ¤å®š
```

### 2. ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœã®ç¢ºèª

```bash
# ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ
cat reviews/$(ls -t reviews/*_code_*.json | head -1)

# ãƒ†ã‚¹ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ
cat reviews/$(ls -t reviews/*_test_*.json | head -1)
```

### 3. è‡ªå‹•ä¿®å¾©ï¼ˆCIé€£æºï¼‰

```bash
# ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚ã«è‡ªå‹•å®Ÿè¡Œ
./.claude/auto-ci-repair-agent.sh

# GitHub ActionsçµŒç”±
# .github/workflows/auto-repair.yml
```

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Hooksè¨­å®š](../.claude/hooks.json)
- [CI/CDè¨­è¨ˆ](../../ci/README.md)
- [å“è³ªã‚²ãƒ¼ãƒˆè©³ç´°](../../CLAUDE.md)

## ğŸ¯ é‹ç”¨ãƒãƒªã‚·ãƒ¼

### çµ¶å¯¾ãƒ«ãƒ¼ãƒ«

1. **å·¥ç¨‹ã‚¹ã‚­ãƒƒãƒ—ç¦æ­¢**: ã™ã¹ã¦ã®Hookã‚’é€šéã™ã‚‹ã“ã¨
2. **HookçµŒç”±ä»¥å¤–ã®é·ç§»ç¦æ­¢**: ç›´æ¥æ¬¡å·¥ç¨‹ã«é€²ã¾ãªã„
3. **ãƒ¬ãƒ“ãƒ¥ãƒ¼FAILæ™‚ã¯å·®ã—æˆ»ã—**: å¿…ãšä¿®æ­£ã™ã‚‹ã“ã¨
4. **ä»•æ§˜å¤–å®Ÿè£…ç¦æ­¢**: è¨­è¨ˆæ›¸ã«æ›¸ã„ã¦ã„ãªã„ã“ã¨ã¯å®Ÿè£…ã—ãªã„
5. **æœªå®Ÿè£…æ‰±ã„**: è¨­è¨ˆã«æ›¸ã„ã¦ã„ãªã„ã“ã¨ã¯æœªå®Ÿè£…

### ä¸¦åˆ—é–‹ç™ºãƒ«ãƒ¼ãƒ«

1. **å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ„ãƒªãƒ¼**: å„SubAgentã¯1ãƒ•ã‚¡ã‚¤ãƒ«ãƒ„ãƒªãƒ¼ã®ã¿æ‹…å½“
2. **åŒæ™‚æ›¸ãè¾¼ã¿ç¦æ­¢**: åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®åŒæ™‚æ›¸ãè¾¼ã¿ã¯ç¦æ­¢
3. **å…±æœ‰è¨­å®šé›†ç´„**: å…±æœ‰è¨­å®šã¯ `config/*` ã«é›†ç´„
4. **ç«¶åˆæ™‚ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**: ç«¶åˆç™ºç”Ÿæ™‚ã¯ spec-planner ã«å¼·åˆ¶ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

## ğŸš€ è‡ªå‹•CIä¿®å¾©

### æš´èµ°é˜²æ­¢æ©Ÿæ§‹

1. **å›æ•°åˆ¶é™**: æœ€å¤§5å›ã¾ã§
2. **åŒä¸€ã‚¨ãƒ©ãƒ¼æ¤œå‡º**: åŒã˜ã‚¨ãƒ©ãƒ¼2å›ã§ä¸­æ­¢
3. **å·®åˆ†é‡ã‚¬ãƒ¼ãƒ‰**: 20è¡Œè¶…ã§ä¸­æ­¢
4. **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã‚¬ãƒ¼ãƒ‰**: æŒ‡å®šãƒ•ã‚¡ã‚¤ãƒ«ä»¥å¤–ã®å¤‰æ›´ã§ä¸­æ­¢

### å®Ÿè¡Œæ¡ä»¶

- ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚ã®ã¿
- manual approvalãŒä¸è¦ãªå ´åˆã®ã¿
- ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã®ã¿ï¼ˆæœ¬ç•ªç’°å¢ƒã§ã¯å®Ÿè¡Œã—ãªã„ï¼‰

## ğŸ“Š ãƒ¡ãƒˆãƒªã‚¯ã‚¹

æ¸¬å®šã™ã¹ãæŒ‡æ¨™ï¼š

| ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | ç›®æ¨™å€¤ |
|----------|-------|
| **ãƒ¬ãƒ“ãƒ¥ãƒ¼é€šéç‡ï¼ˆåˆå›ï¼‰** | >= 80% |
| **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸** | >= 70% |
| **è‡ªå‹•ä¿®å¾©æˆåŠŸç‡** | >= 80% |
| **ãƒ“ãƒ«ãƒ‰æˆåŠŸç‡** | >= 95% |
| **å¹³å‡ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚é–“** | <= 5åˆ† |

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q1: ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒFAILã—ç¶šã‘ã‚‹

- `reviews/*.json` ã‚’ç¢ºèªã—ã€blocking_issues ã‚’ä¿®æ­£
- ä»•æ§˜æ›¸ãƒ»è¨­è¨ˆæ›¸ã¨ã®æ•´åˆæ€§ã‚’ç¢ºèª
- code-reviewer ã®è¦³ç‚¹ã‚’å†ç¢ºèª

### Q2: HookãŒå‹•ä½œã—ãªã„

- `.claude/hooks.json` ã® `enabled: true` ã‚’ç¢ºèª
- Hook ã®ãƒˆãƒªã‚¬ãƒ¼æ¡ä»¶ã‚’ç¢ºèª
- ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚¨ãƒ©ãƒ¼ç¢ºèª

### Q3: è‡ªå‹•ä¿®å¾©ãŒæ­¢ã¾ã‚‰ãªã„

- `.ci_attempt` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤
- `.ci_error_hash` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤
- `auto-repair.yml` ã® `enabled: false` ã«è¨­å®š

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ä»¥ä¸‹ã‚’ç¢ºèªï¼š

1. `.claude/hooks.json` ã®è¨­å®š
2. `reviews/*.json` ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ
3. GitHub Actionsã®ãƒ­ã‚°
4. Memory MCPã®è¨˜éŒ²å†…å®¹

ãã‚Œã§ã‚‚è§£æ±ºã—ãªã„å ´åˆã¯ã€GitHubã®Issueã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
