# =============================================================================
# ITSM-System - Production Environment Configuration
# =============================================================================
# Copy this file to .env.production and fill in the actual values
# NEVER commit .env.production to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# Node Environment
# -----------------------------------------------------------------------------
NODE_ENV=production

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
PORT=5000
HOST=0.0.0.0

# Your production domain (required for SSL)
DOMAIN=your-domain.com

# Email for Let's Encrypt SSL certificate notifications
SSL_EMAIL=admin@your-domain.com

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Comma-separated list of allowed origins
CORS_ORIGIN=https://your-domain.com,https://www.your-domain.com

# -----------------------------------------------------------------------------
# JWT Authentication
# -----------------------------------------------------------------------------
# IMPORTANT: Generate a strong secret using: openssl rand -base64 64
JWT_SECRET=GENERATE_WITH_OPENSSL_RAND_BASE64_64
JWT_EXPIRES_IN=24h

# Refresh token expiration (optional)
JWT_REFRESH_EXPIRES_IN=7d

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
# Path inside container (do not change unless you know what you're doing)
DATABASE_PATH=/app/data/itsm_nexus.db

# SQLite WAL mode settings
SQLITE_JOURNAL_MODE=WAL
SQLITE_BUSY_TIMEOUT=5000

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=warn
LOG_FORMAT=json

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_REQUESTS=5

# -----------------------------------------------------------------------------
# Cache Configuration
# -----------------------------------------------------------------------------
CACHE_TTL=300
CACHE_CHECK_PERIOD=60

# -----------------------------------------------------------------------------
# Email Configuration (optional, for notifications)
# -----------------------------------------------------------------------------
# SMTP Settings
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password
# SMTP_FROM_NAME=ITSM System
# SMTP_FROM_EMAIL=noreply@your-domain.com

# -----------------------------------------------------------------------------
# Microsoft 365 Integration (optional)
# -----------------------------------------------------------------------------
# M365_TENANT_ID=your-tenant-id
# M365_CLIENT_ID=your-client-id
# M365_CLIENT_SECRET=your-client-secret

# -----------------------------------------------------------------------------
# Backup Configuration (optional)
# -----------------------------------------------------------------------------
# Local backup retention (days)
BACKUP_RETENTION_DAYS=7

# S3 Backup (optional)
# BACKUP_S3_BUCKET=itsm-backups
# BACKUP_S3_REGION=us-east-1
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key

# -----------------------------------------------------------------------------
# Monitoring (optional)
# -----------------------------------------------------------------------------
# Enable Prometheus metrics endpoint
METRICS_ENABLED=true

# Grafana Configuration (if using docker-compose with monitoring)
# GRAFANA_ADMIN_PASSWORD=GENERATE_STRONG_PASSWORD

# -----------------------------------------------------------------------------
# Default User Passwords
# -----------------------------------------------------------------------------
# IMPORTANT: Set strong unique passwords for all default users in production.
# If not set, random passwords are generated and shown once in startup logs.
# Generate with: openssl rand -base64 24
ADMIN_PASSWORD=GENERATE_STRONG_PASSWORD
MANAGER_PASSWORD=GENERATE_STRONG_PASSWORD
ANALYST_PASSWORD=GENERATE_STRONG_PASSWORD
VIEWER_PASSWORD=GENERATE_STRONG_PASSWORD

# -----------------------------------------------------------------------------
# Security Settings
# -----------------------------------------------------------------------------
# Session settings
SESSION_SECRET=GENERATE_WITH_OPENSSL_RAND_BASE64_64

# Two-factor authentication
TFA_ISSUER=ITSM-System
TFA_ALGORITHM=sha512

# Password policy
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBER=true
PASSWORD_REQUIRE_SPECIAL=true

# Account lockout
LOCKOUT_THRESHOLD=5
LOCKOUT_DURATION_MINUTES=30

# -----------------------------------------------------------------------------
# Feature Flags (optional)
# -----------------------------------------------------------------------------
# FEATURE_VULNERABILITY_SCAN=true
# FEATURE_M365_INTEGRATION=true
# FEATURE_ADVANCED_REPORTING=true

# -----------------------------------------------------------------------------
# Docker Secrets (Alternative to environment variables)
# -----------------------------------------------------------------------------
# If using Docker secrets, set these paths instead of values:
# JWT_SECRET_FILE=/run/secrets/jwt_secret
# SESSION_SECRET_FILE=/run/secrets/session_secret
# SMTP_PASSWORD_FILE=/run/secrets/smtp_password
# M365_CLIENT_SECRET_FILE=/run/secrets/m365_client_secret
# AWS_SECRET_ACCESS_KEY_FILE=/run/secrets/aws_secret_key

# =============================================================================
# Auto Fix Configuration (Phase 9.3)
# =============================================================================

# 自動修復機能の有効化
AUTO_FIX_ENABLED=true

# 実行間隔（cron式）
AUTO_FIX_CRON=*/5 * * * *

# Dry Runモード（true: 実際には修復せず、ログ出力のみ）
# 本番環境では初期は安全のためDry Runを推奨
AUTO_FIX_DRY_RUN=true

# クールダウン期間（秒）
AUTO_FIX_COOLDOWN_SECONDS=300

# Critical アクションの手動承認要求（本番環境では必須推奨）
AUTO_FIX_REQUIRE_APPROVAL=true

# アラート通知設定
AUTO_FIX_ALERT_EMAIL=admin@your-domain.com
AUTO_FIX_ALERT_SLACK_WEBHOOK=

# ログサイズ閾値（MB）
AUTO_FIX_MAX_LOG_SIZE_MB=100

# ログ保持期間（日）
AUTO_FIX_LOG_RETENTION_DAYS=30
